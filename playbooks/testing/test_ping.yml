---
- name: Ping Test
  hosts: switches
  gather_facts: no
  connection: local

  tasks:
    - name: Ping device
      delegate_to: localhost
      ansible.builtin.command: ping -c 4 {{ ansible_host }}
      register: ping_result
      failed_when: false
      changed_when: false

    - name: Show result
      ansible.builtin.debug:
        msg:
          - "{{ inventory_hostname }} ({{ ansible_host }}): {{ 'SUCCESS ✓' if ping_result.rc == 0 else 'FAILED ✗' }}"
          - "{{ ping_result.stdout_lines | select('search', 'packets transmitted') | first }}"


